# ***** THIS FILE IS MANAGED BY PUPPET *****
# files/private/mdct-00fs.dartcontainer.com/mirrmaid/mirrmaid-fedora.conf
#
# vim: foldmethod=marker
#
# mirrmaid configuration
#
# See the Python documentation for ConfigParser for full details, but in
# general you assign values with either 'key: value' or 'key = value'.  Values
# may be continued on successive lines provided they begin with one or more
# whitespace characters.  Leading and trailing whitespace is trimmed. Because
# of the interpolation features of ConfigParser, any percent signs (%) that
# are to be taken as such, must be doubled (%%).


[MIRRMAID] # {{{1

### Operations Summary Controls ###

# Since mirrmaid is not a daemon, it only runs as scheduled by cron (or other
# means).  Thus the operations summaries cannot be triggered and sent
# unless/until mirrmaid is actually running.  Keep this in mind when
# considering the following options.

# summary_recipients is a list of email addresses to whom the operations
# summaries should be sent.  If set, this must be a valid Python list.
#
# OPTIONAL; DEFAULT IS
summary_recipients: ["john.florian@dart.biz",]

# This option controls the minimum number of seconds that mirrmaid will wait
# after sending an operations summary via email before sending another.
# A minimum value of ten minutes is silently enforced.
#
# OPTIONAL; DEFAULT IS (24 hours)
#summary_interval: 86400

# If the size (in bytes) of the operations summary has exceeded the
# {summary_interval} threshold, the email will be sent early without
# necessarily waiting for the {summary_interval} to have elapsed.  This can be
# useful to alert the {summary_recipients} of major trouble in a more
# expedient way.  Set this to zero to defeat this feature.
#
# OPTIONAL; DEFAULT IS
#summary_size: 20000

# mirrmaid will keep {summary_history_count} historical copies of operational
# summaries on disk before they are rotated out of existence.  A minimum value
# of one is silently enforced.
#
# OPTIONAL; DEFAULT IS
#summary_history_count: 3

# If you have multiple mirrmaid configurations/jobs established on a single
# host, you may wish to keep the operations summaries distinct for each.  Each
# {summary_group} will result in a distinct operations summary and may be
# shared among any number of configurations/jobs.  The value of
# {summary_group} can be anything you wish.  It will be included in the email
# subject like so:
#       mirrmaid Activity Summary for {summary_group}
#
# OPTIONAL; DEFAULT IS
summary_group: Fedora Mirrors


[DEFAULT] # {{{1

# rsync_options -- REQUIRED
# General options to be passed to rsync.  Note that order can be important, as
# some options may override some or all of others.
rsync_options: [
    "--archive",
    "--delay-updates",
    "--delete-delay",
    "--delete-excluded",
    "--hard-links",
    "--no-motd",
    "--partial-dir", ".rsync-partial",
    "--stats",
    "--verbose",

    # These MUST be kept after the above!
    "--no-group",
    "--no-owner",

    # This is useful to enable prior to making any significant change here.
    #"--dry-run",
    ]

# Here you may define other values for reuse in other sections.  To use the
# values, simply use the pattern '%(name)s'.  Values defined here in the DEFAULT
# section are unique in that they may be used in any other section.  In essence,
# their global whereas in any other section, they're local.

# Tier 1 Mirrors {{{2

# US - kernel.org - 2000 Mbps (no rawhide!)
m1_source: rsync://mirrors.kernel.org
m1_prefix: fedora

# US - Rochester Institute of Technology - 500 Mbps
m2_source: rsync://mirrors.rit.edu
m2_prefix: fedora

# US - Georgia Tech - 300 Mbps
m3_source: rsync://rsync.gtlib.gatech.edu
m3_prefix: fedora-enchilada/linux

# US - Duke University - 100 Mbps
m4_source: rsync://archive.linux.duke.edu
m4_prefix: fedora/linux

# Lower Tier Mirrors {{{2

# US - TDS - 1000 Mbps
m5_source: rsync://fedora.mirrors.tds.net
m5_prefix: fedora-enchilada

# US - Energy Sciences Network Public Mirror - 1000 Mbps
m6_source: rsync://linux.mirrors.es.net
m6_prefix: fedora/linux

# Default Source, Target, Inclusions and Exclusions {{{2
# Here we choose one of the above mirrors to use as a source.
def_source: %(m1_source)s
def_prefix: %(m1_prefix)s

# Our mirror root and general mirroring preferences:
def_target: /pub/fedora

fedora_includes: [
    ".treeinfo*",
    ]

fedora_excludes: [
    ### File Exclusions ###
    "*-Live.iso",
    "*-disc[1-9].iso",
    ".*",

    ### Directory Exclusions ###
    "Cloud/",
    "Cloud_Atomic/",
    "Docker/",
    "EFI/",
    "Images/",
    "Live/",
    "SRPMS/",
    "arm*/",
    "debug/",
    "drpms/",
    "jiggdo/",
    "ppc*/",
    "source/",
    ]

fedora_development_excludes: [
    ### File Exclusions ###
    "*-Live.iso",
    "*-disc[1-9].iso",
    "*.iso",
    ".*",

    ### Directory Exclusions ###
    "arm*/",
    "debug/",
    "drpms/",
    "EFI/",
    "jiggdo/",
    "Live/",
    "LiveOS/",
    "ppc*/",
    "source/",
    "SRPMS/",
    ]


[MIRRORS] # {{{1

# enabled -- REQUIRED
# Names of mirrors to be managed.  Each named mirror requires its own named
# section with details for that mirror.  Mirrors will be synchronized in the
# order listed here.

#
# XXX: Be sure to disable Fedora releases just after EoL.  The project
# archives their content shortly (about a month?) thereafter and if it is
# still enabled here, all our content for that release will be replaced with
# a simple README file directing you to the archives.
#
enabled: [
    "fedora-rawhide",
    #"fedora-23-development",
    #"fedora-23-updates",
    #"fedora-23-updates-testing",
    "fedora-22-release",
    "fedora-22-updates",
    "fedora-22-updates-testing",
    "fedora-21-release",
    "fedora-21-updates",
    "fedora-21-updates-testing",
    ]


# Define each mirror below.  At a minimum, each enabled mirror must be defined
# and must provide the following keys:
#       source          The rsync URI of what is to be mirrored.
#       target          The rsync URI of where the mirror is to be kept.
#       include         A Python list of patterns to be included in the
#                       mirror.
#       exclude         A Python list of patterns to be excluded from the
#                       mirror.


# Fedora Rawhide # {{{2
[fedora-rawhide]

branch: development/rawhide
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_development_excludes)s


# Fedora 23 Development # {{{2
[fedora-23-development]

branch: development/23
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_development_excludes)s


[fedora-23-updates]

branch: updates/23
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s


[fedora-23-updates-testing]

branch: updates/testing/23
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s


# Fedora 22 # {{{2
[fedora-22-release]

branch: 22
source_branch: %(def_prefix)s/releases/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s


[fedora-22-updates]

branch: updates/22
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s


[fedora-22-updates-testing]

branch: updates/testing/22
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s


# Fedora 21 # {{{2
[fedora-21-release]

branch: 21
source_branch: %(def_prefix)s/releases/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s


[fedora-21-updates]

branch: updates/21
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s


[fedora-21-updates-testing]

branch: updates/testing/21
source_branch: %(def_prefix)s/%(branch)s
target_branch: %(branch)s
source: %(def_source)s/%(source_branch)s
target: %(def_target)s/%(target_branch)s
include: %(fedora_includes)s
exclude: %(fedora_excludes)s
