# hiera/common.yaml
#
# Synopsis:
#       These settings are common to all Puppet nodes.  They may be overrided
#       selectively according to the Hiera hierarchy.  See /etc/hiera.yaml for
#       more details.


---

chrony::servers:
    # Dart has a dedicated hardware stratum 1 time server.
    - 10.1.0.97 iburst
    # Each of Dart's WAN routers is also a time server.
    - "%{::default_route} iburst"


filesystem:
    mount_opts:
        fs:                 rw,nosuid,nodev,async,relatime,acl
        nfs:                hard


http_proxy:                 mdct-proxy.dartcontainer.com


network::service:           nm
network::domain:            "%{::domain}"
network::name_servers:
    - 10.201.40.69
    - 10.201.40.70

openssh::server::source:    "puppet:///modules/dart/openssh/sshd_config.%{::operatingsystem}.%{::operatingsystemrelease}"


# It's generally advisable for services to use a proper internal MX host
# rather than to expect each server to also play the role of mail forwarder.
sendmail::enable:           false
sendmail::ensure:           stopped


sudo::drop_in::source:      puppet:///modules/dart/sudo/mdct

tsocks::local_networks:
    # Most Dart resources are located here.
    - 10.0.0.0/255.0.0.0
    # The MDCT SOCKS proxy lives here, which is also local.
    - 172.26.26.0/255.255.254.0
tsocks::proxy_server:       "%{hiera('http_proxy')}"
tsocks::server_type:        5


# Dart has no need for delta rpms since we have a local mirror.
yum::deltarpm:              0
# Instruct upstream caches to only cache the RPM package downloads and not the
# repository metadata.  This alleviates certain caching issues we've seen on
# occasion.
yum::http_caching:          packages
